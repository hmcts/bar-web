{"type":"auditAdvisory","data":{"resolution":{"id":1643,"path":"pug","dev":false,"optional":false,"bundled":false},"advisory":{"findings":[{"version":"2.0.3","paths":["pug"]}],"id":1643,"created":"2021-03-03T02:09:54.865Z","updated":"2021-03-03T02:17:05.831Z","deleted":null,"title":"Remote Code Execution","found_by":{"link":"","name":"Anonymous","email":""},"reported_by":{"link":"","name":"Anonymous","email":""},"module_name":"pug","cves":["CVE-2021-21353"],"vulnerable_versions":"<3.0.1","patched_versions":">=3.0.1","overview":"### Impact\n\nIn affected versions of `pug` and `pug-code-gen`, if a remote attacker was able to control the `pretty` option of the pug compiler, e.g. if you spread a user provided object such as the query parameters of a request into the pug template inputs, it was possible for them to achieve remote code execution on the node.js backend.\n\n### Patches\n\nUpgrade to `pug@3.0.1` or `pug-code-gen@3.0.2` or `pug-code-gen@2.0.3`, which correctly sanitise the parameter.\n\n### Workarounds\n\nIf there is no way for un-trusted input to be passed to pug as the `pretty` option, e.g. if you compile templates in advance before applying user input to them, you do not need to upgrade.","recommendation":"Upgrade `pug` to version 3.0.1","references":"- [GitHub Advisory](https://github.com/advisories/GHSA-p493-635q-r6gr)\n- [CVE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21353)\n- [Similar advisory for `pug-code-gen`](https://www.npmjs.com/advisories/1644)","access":"public","severity":"high","cwe":"CWE-74","metadata":{"module_type":"","exploitability":8,"affected_components":""},"url":"https://npmjs.com/advisories/1643"}}}
{"type":"auditAdvisory","data":{"resolution":{"id":1644,"path":"pug>pug-code-gen","dev":false,"optional":false,"bundled":false},"advisory":{"findings":[{"version":"2.0.2","paths":["pug>pug-code-gen"]}],"id":1644,"created":"2021-03-03T02:16:22.974Z","updated":"2021-03-03T02:17:24.599Z","deleted":null,"title":"Remote Code Execution","found_by":{"link":"","name":"Anonymous","email":""},"reported_by":{"link":"","name":"Anonymous","email":""},"module_name":"pug-code-gen","cves":["CVE-2021-21353"],"vulnerable_versions":"<2.0.3||>=3.0.0 <3.0.2","patched_versions":">=2.0.3 <3.0.0||>=3.0.2","overview":"### Impact\n\nIn affected versions of `pug` and `pug-code-gen`, if a remote attacker was able to control the `pretty` option of the pug compiler, e.g. if you spread a user provided object such as the query parameters of a request into the pug template inputs, it was possible for them to achieve remote code execution on the node.js backend.\n\n### Patches\n\nUpgrade to `pug@3.0.1` or `pug-code-gen@3.0.2` or `pug-code-gen@2.0.3`, which correctly sanitise the parameter.\n\n### Workarounds\n\nIf there is no way for un-trusted input to be passed to pug as the `pretty` option, e.g. if you compile templates in advance before applying user input to them, you do not need to upgrade.","recommendation":"Upgrade `pug-code-gen` to version 2.0.3 or 3.0.2.","references":"- [GitHub Advisory](https://github.com/advisories/GHSA-p493-635q-r6gr)\n- [CVE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21353)\n- [Similar advisory for `pug`](https://www.npmjs.com/advisories/1643)","access":"public","severity":"high","cwe":"CWE-74","metadata":{"module_type":"","exploitability":8,"affected_components":""},"url":"https://npmjs.com/advisories/1644"}}}
